###############################################################################
#  BTT Eddy Probe Configuration for Sovol SV06 Plus
#
#  IMPORTANT: This config assumes the Eddy is connected via USB/CAN
#  Adjust the serial/canbus settings according to your actual connection
#
#  Features:
#  - High-speed probing (much faster than inductive probes)
#  - Temperature compensation
#  - Z-offset calibration
#
#  Installation:
#  1. Connect BTT Eddy to your BTT Pi via USB or CAN
#  2. Find device: ls /dev/serial/by-id/
#  3. Update the serial path below
#  4. Include this file in osskc.cfg: [include ./cfgs/btt-eddy.cfg]
#  5. Comment out the old [probe] section in printer.cfg
#  6. Run PROBE_CALIBRATE to set your Z-offset
#
###############################################################################

# NOTE: Uncomment ONE of the connection methods below

# Option 1: USB Connection
# [mcu eddy]
# serial: /dev/serial/by-id/usb-Klipper_rp2040_YOUR_ID_HERE
# restart_method: command

# Option 2: CAN Connection (if using CAN bus)
# [mcu eddy]
# canbus_uuid: YOUR_CAN_UUID_HERE
# canbus_interface: can0

# BTT Eddy Probe Configuration
[probe_eddy_current btt_eddy]
# NOTE: Update sensor_type if you have a different model
# sensor_type: ldc1612  # For standard BTT Eddy
sensor_type: ldc1612
i2c_mcu: eddy  # Replace with your MCU name if different
i2c_bus: i2c0f  # i2c0f for RP2040, check your specific board

# Calibration and offsets
# NOTE: These are example values - you MUST calibrate these!
x_offset: 27.0   # Distance from nozzle to probe in X (adjust to your mount)
y_offset: -20.0  # Distance from nozzle to probe in Y (adjust to your mount)
#z_offset: 0.0   # Will be set by PROBE_CALIBRATE - comment out initially

# Probing settings
samples: 3
samples_result: median
samples_tolerance: 0.005  # Eddy is more precise, can use tighter tolerance
samples_tolerance_retries: 5

# Speed settings - Eddy can probe much faster
speed: 10.0              # Probing speed (can go up to 15mm/s with Eddy)
lift_speed: 15.0         # Z-lift speed between probes

# Eddy-specific settings
#reg_drive_current: 15   # Drive current (default: 15, range: 0-31)
#calibration_temp: 25    # Temperature at which you calibrated

# Temperature compensation (optional but recommended)
# [temperature_probe btt_eddy]
# sensor_type: temperature_mcu
# sensor_mcu: eddy
# min_temp: 10
# max_temp: 100

# Update bed_mesh settings for faster probing with Eddy
[bed_mesh]
speed: 250                # Much faster with Eddy! (was 175)
horizontal_move_z: 2      # Can be lower with Eddy (was 5-10mm typically)
mesh_min: 27, 6
mesh_max: 280, 280
probe_count: 9, 9         # Higher resolution possible due to speed!
algorithm: bicubic
fade_start: 1
fade_end: 10
fade_target: 0

# Temperature-based mesh calibration (advanced, optional)
# [gcode_macro BED_MESH_CALIBRATE_WITH_TEMP]
# gcode:
#     {% set BED_TEMP = params.BED_TEMP|default(60)|float %}
#     M190 S{BED_TEMP}
#     G28
#     BED_MESH_CALIBRATE
#     SAVE_CONFIG

###############################################################################
# INSTALLATION INSTRUCTIONS:
#
# 1. Connect your BTT Eddy to the BTT Pi
#
# 2. Find the serial ID:
#    SSH into your Pi and run:
#    ls /dev/serial/by-id/
#
# 3. Update the [mcu eddy] section above with your actual serial ID
#
# 4. Include this file in osskc.cfg:
#    Add line: [include ./cfgs/btt-eddy.cfg]
#
# 5. Comment out OLD probe section in printer.cfg:
#    Find [probe] section and add # before each line
#
# 6. Restart Klipper:
#    FIRMWARE_RESTART
#
# 7. Calibrate Z-offset:
#    G28
#    PROBE_CALIBRATE
#    Follow the paper test procedure
#    ACCEPT
#    SAVE_CONFIG
#
# 8. Test probe:
#    G28
#    BED_MESH_CALIBRATE
#
# 9. Verify mesh quality:
#    Check that mesh completes quickly (should be ~2-3x faster than before)
#
###############################################################################
